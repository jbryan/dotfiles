#!/usr/bin/env bash

# disable default prompt
VIRTUAL_ENV_DISABLE_PROMPT=1

# Function to get git branch
get_git_branch() {
    git branch 2>/dev/null | grep '^*' | sed 's/^* //'
}

# Function to get venv relative path
get_venv_path() {
    if [ -n "$VIRTUAL_ENV" ]; then
        realpath --relative-to="$PWD" "$VIRTUAL_ENV" 2>/dev/null
    fi
}

# Break PS1 into substrings for each part
PS1_USER='\[\033[1;33m\]\u@\h\[\033[0m\]'
PS1_DIR=':\[\033[1;34m\]\w\[\033[0m\]'
PS1_GIT='$(branch=$(get_git_branch); [ -n "$branch" ] && echo "\[\033[0;32m\] ÓÇ† $branch\[\033[0m\]")'
PS1_VENV='$(venv=$(get_venv_path); [ -n "$venv" ] && echo " \[\033[1;36m\]üêç$venv\[\033[0m\]")'
PS1_PROMPT=' $ '

PS1="${PS1_USER}${PS1_DIR}${PS1_GIT}${PS1_VENV}${PS1_PROMPT}"
